DROP TABLE IF EXISTS hospital_time_04;
CREATE EXTERNAL TABLE IF NOT EXISTS hospital_time_04(
	hospital_time_id int,
	hospital_id int,
	hospital_time_mon string,
	hospital_time_tue string,
	hospital_time_wed string,
	hospital_time_thu string,
	hospital_time_fri string,
	hospital_time_sat string,
	hospital_time_sun string,
	hospital_time_mon_night boolean,
	hospital_time_tue_night boolean,
	hospital_time_wed_night boolean,
	hospital_time_thu_night boolean,
	hospital_time_fri_night boolean,
	hospital_time_sat_night boolean,
	hospital_time_sun_night boolean,
	hospital_time_holiday boolean,
	hospital_time_etc string
);


INSERT OVERWRITE TABLE hospital_time_04
	SELECT 
		hospital_time_id,
		hospital_id,
		hospital_time_mon,
		hospital_time_tue,
		hospital_time_wed,
		hospital_time_thu,
		hospital_time_fri,
		hospital_time_sat,
		hospital_time_sun,
		CASE WHEN hospital_time_mon != 'null' AND substring(hospital_time_mon, 7, 5) > '18:00' THEN true
			ELSE false END,
		CASE WHEN hospital_time_tue != 'null' AND substring(hospital_time_tue, 7, 5) > '18:00' THEN true
			ELSE false END,
		CASE WHEN hospital_time_wed != 'null' AND substring(hospital_time_wed, 7, 5) > '18:00' THEN true
			ELSE false END,
		CASE WHEN hospital_time_thu != 'null' AND substring(hospital_time_thu, 7, 5) > '18:00' THEN true
			ELSE false END,
		CASE WHEN hospital_time_fri != 'null' AND substring(hospital_time_fri, 7, 5) > '18:00' THEN true
			ELSE false END,
		CASE WHEN hospital_time_sat != 'null' AND substring(hospital_time_sat, 7, 5) > '18:00' THEN true
			ELSE false END,
		CASE WHEN hospital_time_sun != 'null' AND substring(hospital_time_sun, 7, 5) > '18:00' THEN true
			ELSE false END,
		false,
		hospital_time_etc
	FROM hospital_time_03;




