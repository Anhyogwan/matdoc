DROP TABLE IF EXISTS hospital_time;
CREATE EXTERNAL TABLE IF NOT EXISTS hospital_time(
	hospital_time_id int,
	hospital_id int,
	hospital_time_mon string,
	hospital_time_tue string,
	hospital_time_wed string,
	hospital_time_thu string,
	hospital_time_fri string,
	hospital_time_sat string,
	hospital_time_sun string,
	hospital_time_mon_night boolean,
	hospital_time_tue_night boolean,
	hospital_time_wed_night boolean,
	hospital_time_thu_night boolean,
	hospital_time_fri_night boolean,
	hospital_time_sat_night boolean,
	hospital_time_sun_night boolean,
	hospital_time_holiday boolean,
	hospital_time_etc string
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
STORED AS TEXTFILE 
LOCATION 'hdfs://127.0.0.1:9000/user/hive/warehouse/hospital/result/hospital_time';


INSERT OVERWRITE TABLE hospital_time
	SELECT 
		hospital_time_id,
		hospital_id,
		hospital_time_mon,
		hospital_time_tue,
		hospital_time_wed,
		hospital_time_thu,
		hospital_time_fri,
		hospital_time_sat,
		hospital_time_sun,
		hospital_time_mon_night,
		hospital_time_tue_night,
		hospital_time_wed_night,
		hospital_time_thu_night,
		hospital_time_fri_night,
		hospital_time_sat_night,
		hospital_time_sun_night,
		CASE WHEN hospital_time_etc LIKE '%공휴일 휴무%' THEN false
			WHEN hospital_time_etc LIKE '%공휴일휴무%' THEN false
			ELSE hospital_time_holiday END,
		CASE WHEN hospital_time_etc = '정보 없음' THEN 'null'
			WHEN length(hospital_time_etc) = 0 THEN 'null'
			ELSE hospital_time_etc END
	FROM hospital_time_05;